<!DOCTYPE html><html>import base64&#10;import requests&#10;&#10;vim_url = 'https://pastacolsugo.github.io/btw/vim/vim-b64.html'&#10;vim_url_parts = [&#10;&#9;'https://pastacolsugo.github.io/btw/vim/vim-b64-1.html',&#10;&#9;'https://pastacolsugo.github.io/btw/vim/vim-b64-2.html'&#10;]&#10;&#10;def parse_achecker(raw):&#10;&#9;entities = {&#10;&#9;&#9;'&lt;':'<',&#10;&#9;&#9;'&gt;':'>',&#10;&#9;&#9;'&amp;':'&',&#10;&#9;&#9;'&quot;':'"',&#10;&#9;}&#10;&#10;&#9;out = ''&#10;&#10;&#9;raw = raw.split('<ol class="source">')[-1].split('</ol>')[0]&#10;&#9;raw = raw.replace('</li>', '')&#10;&#10;&#9;for l in raw.split('\n'):&#10;&#9;&#9;if l == '':&#10;&#9;&#9;&#9;continue&#10;&#9;&#9;out += l.split('>')[-1] + '\n'&#10;&#10;&#9;for (k, v) in entities.items():&#10;&#9;&#9;out = out.replace(k, v)&#10;&#10;&#9;return out[:-2]&#10;&#10;def parse_validator(raw):&#10;&#9;entities = {&#10;&#9;&#9;'&lt;':'<',&#10;&#9;&#9;'&gt;':'>',&#10;&#9;&#9;'&amp;':'&',&#10;&#9;&#9;'&quot;':'"',&#10;&#9;}&#10;&#10;&#9;out = ''&#10;&#10;&#9;raw = raw.split('<ol class="source">')[-1].split('</ol>')[0]&#10;&#9;raw = raw.replace('<code class="lf" title="Line break">â†©</code>', '\n')&#10;&#9;lines = raw.split('</li>')&#10;&#10;&#9;for l in lines:&#10;&#9;&#9;res = ''&#10;&#9;&#9;blocks = l.split('>')&#10;&#9;&#9;for b in blocks:&#10;&#9;&#9;&#9;if len(b) == 0:&#10;&#9;&#9;&#9;&#9;continue&#10;&#9;&#9;&#9;if b[0] != '<':&#10;&#9;&#9;&#9;&#9;res += b.split('<')[0]&#10;&#9;&#9;out += res&#10;&#10;&#9;for (k, v) in entities.items():&#10;&#9;&#9;out = out.replace(k, v)&#10;&#10;&#9;return out&#10;&#10;def request_achecker(url):&#10;&#9;headers = {&#10;&#9;&#9;'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',&#10;&#9;&#9;'Accept-Language': 'en-US,en;q=0.9,it-IT;q=0.8,it;q=0.7',&#10;&#9;&#9;'Cache-Control': 'no-cache',&#10;&#9;&#9;'Connection': 'keep-alive',&#10;&#9;&#9;'Content-Type': 'multipart/form-data; boundary=----WebKitFormBoundary7n1AcKKn3XJHcyCa',&#10;&#9;&#9;'DNT': '1',&#10;&#9;&#9;'Origin': 'null',&#10;&#9;&#9;'Pragma': 'no-cache',&#10;&#9;&#9;'Upgrade-Insecure-Requests': '1',&#10;&#9;&#9;'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36',&#10;&#9;&#9;'sec-gpc': '1',&#10;&#9;}&#10;&#10;&#9;data = f'------WebKitFormBoundary7n1AcKKn3XJHcyCa\r\nContent-Disposition: form-data; name="uri"\r\n\r\n{url}\r\n------WebKitFormBoundary7n1AcKKn3XJHcyCa\r\nContent-Disposition: form-data; name="validate_uri"\r\n\r\nCheck It\r\n------WebKitFormBoundary7n1AcKKn3XJHcyCa\r\nContent-Disposition: form-data; name="MAX_FILE_SIZE"\r\n\r\n52428800\r\n------WebKitFormBoundary7n1AcKKn3XJHcyCa\r\nContent-Disposition: form-data; name="uploadfile"; filename=""\r\nContent-Type: application/octet-stream\r\n\r\n\r\n------WebKitFormBoundary7n1AcKKn3XJHcyCa\r\nContent-Disposition: form-data; name="pastehtml"\r\n\r\n------WebKitFormBoundarycSYAqAzAu2behcHi\r\nContent-Disposition: form-data; name="show_source"\r\n\r\n1\r\n------WebKitFormBoundary7n1AcKKn3XJHcyCa\r\nContent-Disposition: form-data; name="show_source"\r\n\r\n1\r\n------WebKitFormBoundary7n1AcKKn3XJHcyCa\r\nContent-Disposition: form-data; name="radio_gid[]"\r\n\r\n8\r\n------WebKitFormBoundary7n1AcKKn3XJHcyCa\r\nContent-Disposition: form-data; name="checkbox_gid[]"\r\n\r\n8\r\n------WebKitFormBoundary7n1AcKKn3XJHcyCa\r\nContent-Disposition: form-data; name="rpt_format"\r\n\r\n1\r\n------WebKitFormBoundary7n1AcKKn3XJHcyCa--\r\n' &#10;&#10;&#9;print(f'Get cookie')&#10;&#9;init = requests.get('http://achecker.csr.unibo.it/checker/index.php')&#10;&#9;cookies = init.cookies.get_dict()&#10;&#10;&#9;print(f'Requesting page')&#10;&#9;response = requests.post('http://achecker.csr.unibo.it/checker/index.php', cookies=cookies, headers=headers, data=data, verify=False)&#10;&#10;&#9;if response.status_code != 200:&#10;&#9;&#9;print(f'Error: status {response.status_code}')&#10;&#9;&#9;exit(0)&#10;&#10;&#9;return parse_achecker(response.text)&#10;&#10;def request_validator(url):&#10;&#9;headers = {&#10;&#9;&#9;'authority': 'validator.w3.org',&#10;&#9;&#9;'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',&#10;&#9;&#9;'accept-language': 'en-US,en;q=0.9,it-IT;q=0.8,it;q=0.7',&#10;&#9;&#9;'cache-control': 'no-cache',&#10;&#9;&#9;'dnt': '1',&#10;&#9;&#9;'pragma': 'no-cache',&#10;&#9;&#9;'sec-ch-ua': '"Chromium";v="112", "Google Chrome";v="112", "Not:A-Brand";v="99"',&#10;&#9;&#9;'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36',&#10;&#9;}&#10;&#10;&#9;params = {&#10;&#9;&#9;'showsource': 'yes',&#10;&#9;&#9;'doc': f'{url}',&#10;&#9;}&#10;&#10;&#9;response = requests.get('https://validator.w3.org/nu/', params=params, headers=headers)&#10;&#10;&#9;if response.status_code != 200:&#10;&#9;&#9;print(f'Errore: status {response.status_code}')&#10;&#9;&#9;exit(0)&#10;&#10;&#9;return parse_validator(response.text)&#10;&#10;def file_to_b64_html(filename):&#10;&#9;def outname(fn):&#10;&#9;&#9;return '.'.join(fn.split('.')[:-1]) + '.b64.html'&#10;&#10;&#9;print(f'{filename} => {outname(filename)}')&#10;&#9;file = None&#10;&#10;&#9;with open(filename, 'rb') as f:&#10;&#9;&#9;file = f.read()&#10;&#10;&#9;b64 = base64.b64encode(file).decode()&#10;&#9;b64_html = '<!DOCTYPE html><html name="filename">' + b64&#10;&#10;&#9;with open(outname(filename), 'w') as out:&#10;&#9;&#9;out.write(b64_html)&#10;&#10;def file_b64_html_to_file(filename):&#10;&#9;with open(filename, 'r') as f:&#10;&#9;&#9;b64_html = f.read()&#10;&#9;b64_html_to_file(b64_html)&#10;&#10;def b64_html_to_file(b64_html):&#10;&#9;filename = b64_html.split('>')[1].split('"')[1]&#10;&#9;print(f'filename={filename}')&#10;&#9;b64 = b64_html.split('>')[-1]&#10;&#9;res = base64.b64decode(b64.encode())&#10;&#9;with open(filename, 'wb') as out:&#10;&#9;&#9;out.write(res)&#10;&#10;def get_vim(bypass='achecker'):&#10;&#9;if bypass == 'validator':&#10;&#9;&#9;vim_b64 = request_validator(vim_url)&#10;&#10;&#9;if bypass == 'achecker':&#10;&#9;&#9;vim_b64_p1 = request_achecker(vim_url_parts[0])&#10;&#9;&#9;vim_b64_p2 = request_achecker(vim_url_parts[1])&#10;&#9;&#9;vim_b64 = vim_b64_p1 + vim_b64_p2[21:]&#10;&#10;&#9;b64_html_to_file(vim_b64)&#10;&#10;if __name__ == "__main__":&#10;&#9;get_vim()